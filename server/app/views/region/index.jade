extends ../layout

block head
    script(type='text/javascript', src="/lodash/index.js")
    script(type='text/javascript', src="/moment/moment.js")
    script(type='text/javascript', src="/jquery/dist/jquery.min.js")
    script(type='text/javascript', src="/angular/angular.js")
    script(type='text/javascript', src="/angular-sanitize/angular-sanitize.js")
    script(type='text/javascript', src="/ng-table/dist/ng-table.js")
    script(type='text/javascript', src="/resources/js/listings.js")
    script(type='text/javascript', src="/resources/js/Model.js")
    script(type='text/javascript', src="/resources/js/FieldModel.js")
    script(type='text/javascript', src="/resources/js/RowModel.js")
    script(type='text/javascript', src="/resources/js/Util.js")
    script(type='text/javascript').
        window.listings = !{ foreclosures };

block content
    div.row(
        ng-app="ControllerListings"
        ng-controller="ControllerListings"
        ng-cloak
    )
        include detail-modal/index
        script(type="text/ng-template" id="ng-table/filters/county.html")
            input.input-filter.form-control(
                type="text"
                name="[[ name ]]"
                placeholder="ex. Madison"
                ng-model="params.filter()[name]"
            )

        script(type="text/ng-template" id="ng-table/filters/date.html")
            input.input-filter.form-control(
                type="text"
                name="[[ name ]]"
                placeholder="m/d/yyyy"
                ng-model="params.filter()[name]"
            )


        div.col-xs-12
            div
                span Displaying [[ tableParams.data.length ]] of [[ tableParams.total() ]] Listings
                if counties
                    div
                        span &nbsp;in&nbsp;
                        span
                            each county, i in counties
                                if i === counties.length - 1
                                    span and&nbsp;
                                span.caps #{county}
                                if i !== counties.length - 1
                                    span ,&nbsp;
                            span &nbsp;Counties
            div.spacer-sm
        div.col-xs-12
            table.table.table-striped.table-bordered.table-hover.bg-white(
                ng-table="tableParams"
                show-filter="true"
            )
                tr(
                    ng-repeat="listing in $data"
                    ng-click="modal.open(listing.index)"
                )
                    td(
                        data-title="'Sale Date'"
                        sortable="'sale_date_sort'"
                        filter="{ 'sale_date': 'date' }"
                    ) [[ listing.sale_date ]]
                    td(
                        data-title="'Address'"
                        sortable="'street_addr'"
                        filter="{ 'street_addr': 'text' }"
                    ) [[ listing.street_addr ]]
                    td(
                        data-title="'Name 1'"
                        sortable="'name1'"
                        filter="{ 'name1': 'text' }"
                    ) [[ listing.name1 ]]
                    td(
                        data-title="'Mortgage $'"
                        sortable="'buy_price'"
                        filter="{ 'buy_price': 'text' }"
                    ) [[ listing.buy_price ]]
                    td(
                        data-title="'Appraisal $'"
                        sortable="'appraisal_price'"
                        filter="{ 'appraisal_price': 'text' }"
                    ) [[ listing.appraisal_price ]]
                    td(
                        data-title="'County'"
                        sortable="'county'"
                        filter="{ 'county': 'county' }"
                    ) [[ listing.county ]]
                    td(
                        data-title="'City'"
                        sortable="'city'"
                        filter="{ 'city': 'text' }"
                    ) [[ listing.city ]]
                    td(
                        data-title="'Attorney'"
                        sortable="'attorney'"
                        filter="{ 'attorney': 'text' }"
                    ) [[ listing.attorney ]]